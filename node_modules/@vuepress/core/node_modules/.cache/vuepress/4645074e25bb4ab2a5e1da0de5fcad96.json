{"remainingRequest":"/Users/onlyone/open-github/technology-talk/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/onlyone/open-github/technology-talk/docs/.vuepress/components/LockArticle.vue?vue&type=style&index=0&id=45ae7568&lang=stylus&","dependencies":[{"path":"/Users/onlyone/open-github/technology-talk/docs/.vuepress/components/LockArticle.vue","mtime":1677049100458},{"path":"/Users/onlyone/open-github/technology-talk/node_modules/css-loader/dist/cjs.js","mtime":1676962415297},{"path":"/Users/onlyone/open-github/technology-talk/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1676962415807},{"path":"/Users/onlyone/open-github/technology-talk/node_modules/postcss-loader/src/index.js","mtime":1676962415295},{"path":"/Users/onlyone/open-github/technology-talk/node_modules/stylus-loader/index.js","mtime":1676962413960},{"path":"/Users/onlyone/open-github/technology-talk/node_modules/cache-loader/dist/cjs.js","mtime":1676962415098},{"path":"/Users/onlyone/open-github/technology-talk/node_modules/vue-loader/lib/index.js","mtime":1676962415466}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiNyZWFkLW1vcmUtYnRuIHsKICAgIGJvcmRlcjogbm9uZSAhaW1wb3J0YW50OwogICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOwogICAgYmFja2dyb3VuZDogIzNlYWY3YyAhaW1wb3J0YW50Owp9CgojcmVhZC1tb3JlLWJ0biB7CiAgICBjb2xvcjogI2ZmZiAhaW1wb3J0YW50OwogICAgdHJhbnNpdGlvbjogYWxsIC41cyBlYXNlOwp9CgojcmVhZC1tb3JlLWJ0bjpob3ZlciB7CiAgICBiYWNrZ3JvdW5kOiAjZGUzNjM2ICFpbXBvcnRhbnQ7Cn0KCi5sb2NrIHsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICBwYWRkaW5nLWJvdHRvbTogMzBweDsKfQo="},{"version":3,"sources":["LockArticle.vue"],"names":[],"mappings":";AAoQA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"LockArticle.vue","sourceRoot":"docs/.vuepress/components","sourcesContent":["<template>\n    <div class=\"read-more-wrap\"\n         style=\"display: none; position: absolute; bottom: 0px; z-index: 9999; width: 100%; margin-top: -100px; font-family: PingFangSC-Regular, sans-serif;\">\n        <div id=\"read-more-mask\"\n             style=\"position: relative; height: 200px; background: -webkit-gradient(linear, 0 0%, 0 100%, from(rgba(255, 255, 255, 0)), to(rgb(255, 255, 255)));\"></div>\n        <a id=\"read-more-btn\" target=\"_self\"\n           style=\"position: absolute; left: 50%; top: 70%; bottom: 30px; transform: translate(-50%, -50%); width: 160px; height: 36px; line-height: 36px; font-size: 15px; text-align: center; border: 1px solid rgb(222, 104, 109); color: rgb(222, 104, 109); background: rgb(255, 255, 255); cursor: pointer; border-radius: 6px;\">阅读全文</a>\n\n        <div id=\"btw-modal-wrap\" style=\"display: none;\">\n            <div id=\"btw-mask\"\n                 style=\"position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0);\"></div>\n            <div id=\"btw-modal\"\n                 style=\"position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 300px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;\">\n            <span id=\"btw-modal-close-btn\"\n                  style=\"position: absolute; top: 5px; right: 15px; line-height: 34px; font-size: 34px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;\">×</span>\n                <p id=\"btw-modal-header\"\n                   style=\"margin-top: 40px; line-height: 1.8; font-size: 13px;\">\n                    扫码或搜索：<span style=\"color: #E9405A; font-weight: bold;\">微观技术</span>\n\n                    <br>发送：<span id=\"fustack-token\" class=\"token\"\n                                 style=\"color: #e9415a; font-weight: bold; font-size: 17px; margin-bottom: 45px;\">290992</span>\n                    <br>即可<span style=\"color: #e9415a; font-weight: bold;\">立即永久</span>解锁本站全部文章</p>\n                <img src=\"/images/personal/qrcode.jpg\"\n                     style=\"width: 180px; margin-top: 10px; margin-bottom: 30px; border: 8px solid rgb(230, 230, 230);\">\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n\n    export default {\n        name: 'LockArticle',\n        data() {\n            return {}\n        },\n        mounted: function () {\n            // 定时任务\n            setInterval(() => {\n                if (this.isLock()) {\n                    let $article = this.articleObj();\n                    this._detect($article, this);\n                }\n            }, 1500);\n\n            // 判断是否锁定文章\n            // if (this.isLock()) {\n            //     setTimeout(() => {\n            //         let $article = this.articleObj();\n            //         this._detect($article, this);\n            //\n            //         // 定时任务\n            //         setInterval(() => {\n            //             this._detect($article, this);\n            //         }, 5000);\n            //\n            //     }, 2000);\n            // }\n\n        },\n        methods: {\n            isLock() {\n                return \"need\" === this.$page.frontmatter.lock;\n            },\n            articleObj: function () {\n                let $article = $('.theme-default-content');\n                if ($article.length <= 0) return null;\n\n                // 文章的实际高度\n                let height = $article[0].clientHeight;\n\n                return {\n                    article: $article,\n                    height: height\n                }\n            },\n            _detect: function (articleObj, t) {\n                if (null == articleObj) return;\n\n                let res = this.getCookie(\"_unlock\");\n                if ('success' === res) {\n                    return;\n                }\n\n                t.getToken().then(function (token) {\n                    $.ajax({\n                        url: 'https://api.offercome.cn/interfaces/BlogApi.php',\n                        type: \"GET\",\n                        dataType: \"text\",\n                        data: {\n                            token: token\n                        },\n                        success: function (data) {\n                            if (data === 'refuse') {\n                                t._lock(articleObj);\n                            } else {\n                                t._unlock(articleObj);\n                                t.setCookie(\"_unlock\", \"success\", 7);\n                            }\n                        },\n                        error: function (data) {\n                            t._unlock(articleObj);\n                        }\n                    })\n                });\n            },\n            _lock: function (articleObj) {\n                let $article = articleObj.article;\n                let height = articleObj.height;\n                if ($article.length <= 0) return;\n\n                // 文章隐藏后的高度\n                let halfHeight = height * 0.3;\n\n                // 篇幅短一点的文章就不需要解锁了\n                if (this.os().isPc && halfHeight > 800) {\n\n                    // 获取口令\n                    this.getToken().then(function (token) {\n                        $('#fustack-token').text(token);\n\n                        // 判断是否已加锁\n                        if ($article.hasClass(\"lock\")) {\n                            return;\n                        }\n\n                        // 设置文章可显示高度\n                        $article.css({\"height\": halfHeight + 'px'});\n                        $article.addClass('lock');\n\n                        // 添加引导解锁标签\n                        $article.remove(\"#read-more-wrap\");\n\n                        let clone = $('.read-more-wrap').clone();\n                        clone.attr('id', 'read-more-wrap');\n                        clone.css('display', 'block');\n\n                        clone.find(\"#read-more-btn\").click(function () {\n                            clone.find(\"#btw-modal-wrap\").css('display', 'block');\n                        });\n\n                        clone.find(\"#btw-modal-close-btn\").click(function () {\n                            clone.find(\"#btw-modal-wrap\").css('display', 'none');\n                        });\n\n                        $article.append(clone);\n                    });\n\n                }\n            },\n            _unlock: function (articleObj) {\n\n                let $article = articleObj.article;\n\n                // 判断是否已加锁\n                if (!$article.hasClass(\"lock\")) {\n                    return;\n                }\n\n                $article.css('height', 'initial');\n                $article.removeClass('lock');\n\n                $('#read-more-wrap').remove();\n\n            },\n            getToken: async function () {\n\t\t\t\t// 浏览器 Cookie true 不限制\n\t\t\t\tif(navigator.cookieEnabled){\n\t\t\t\t\tlet value = this.getCookie('BAEID');\n\t\t\t\t\tif (!value) {\n\t\t\t\t\t\treturn await this.getFingerprintId();\n\t\t\t\t\t}\n\t\t\t\t\treturn value.substring(value.length - 6).toUpperCase();\n\t\t\t\t} else{\n\t\t\t\t\treturn await this.getFingerprintId();\n\t\t\t\t}\n                // return await this.getFingerprintId();\n            },\n            getFingerprintId: function () {\n                // https://github.com/fingerprintjs/fingerprintjs\n               /* new Fingerprint2().get(function(result, components){\n                    let value = result.toUpperCase();\n                    let token = value.substring(value.length - 6).toUpperCase();\n                    // 设置token\n                    $('#fustack-token').text(token);\n                });\n                return $('#fustack-token').text();*/\n                return new Promise( resolve => {\n                    new Fingerprint2().get(function(result, components){\n                        let value = result.toUpperCase();\n                        let token = value.substring(value.length - 6).toUpperCase();\n                        resolve(token);\n                    });\n                })\n            },\n\t\t\tgetUUID: function () {\n                return 'xxxxxx'.replace(/[xy]/g, function (c) {\n                    let r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);\n                    return v.toString(16);\n                });\n            },\n            getCookie: function (name) {\n                let value = \"; \" + document.cookie;\n                let parts = value.split(\"; \" + name + \"=\");\n                if (parts.length === 2)\n                    return parts.pop().split(\";\").shift();\n            },\n            setCookie: function (name, value, hours){\n                let exp = new Date();\n                exp.setTime(exp.getTime() + hours*60*60*1000);\n                // ;path=/ cookie全站有效\n                document.cookie = name + \"=\"+ escape (value) + \";path=/;expires=\" + exp.toGMTString();\n            },\n            os: function () {\n                let ua = navigator.userAgent,\n                    isWindowsPhone = /(?:Windows Phone)/.test(ua),\n                    isSymbian = /(?:SymbianOS)/.test(ua) || isWindowsPhone,\n                    isAndroid = /(?:Android)/.test(ua),\n                    isFireFox = /(?:Firefox)/.test(ua),\n                    isChrome = /(?:Chrome|CriOS)/.test(ua),\n                    isTablet = /(?:iPad|PlayBook)/.test(ua) || (isAndroid && !/(?:Mobile)/.test(ua)) || (isFireFox && /(?:Tablet)/.test(ua)),\n                    isPhone = /(?:iPhone)/.test(ua) && !isTablet,\n                    isPc = !isPhone && !isAndroid && !isSymbian;\n                return {\n                    isTablet: isTablet,\n                    isPhone: isPhone,\n                    isAndroid: isAndroid,\n                    isPc: isPc\n                }\n            }\n        }\n\n    }\n\n</script>\n\n<style lang=\"stylus\">\n    #read-more-btn {\n        border: none !important;\n        text-decoration: none;\n        background: #3eaf7c !important;\n    }\n\n    #read-more-btn {\n        color: #fff !important;\n        transition: all .5s ease;\n    }\n\n    #read-more-btn:hover {\n        background: #de3636 !important;\n    }\n\n    .lock {\n        position: relative;\n        overflow: hidden;\n        padding-bottom: 30px;\n    }\n</style>\n\n"]}]}